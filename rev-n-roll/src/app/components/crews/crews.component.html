<div class="container mx-auto p-4">
  <h2 class="text-2xl font-bold text-neon-red mb-4">Crews</h2>

  <div class="mb-6">
    <button
      mat-raised-button
      color="primary"
      (click)="onCreateCrew()"
      class="w-full md:w-auto submit-button"
    >
      <mat-icon>add</mat-icon>
      Create a New Crew
    </button>
  </div>

  <div *ngIf="isLoading" class="text-center py-8">
    <mat-spinner class="mx-auto" diameter="40"></mat-spinner>
  </div>

  <div *ngIf="errorMessage && !isLoading" class="text-center py-8 text-red-500">
    {{ errorMessage }}
  </div>

  <div *ngIf="!isLoading && !errorMessage" class="space-y-4">
    <div *ngIf="!crews || crews.length === 0" class="text-center py-8">
      <p class="text-lg text-gray-300">No crews have been created yet. Be the first!</p>
    </div>

    <mat-card *ngFor="let crew of crews" class="crew-card bg-gray-800 p-4 rounded-lg shadow-lg relative">
      <div class="flex items-start gap-4">
        <img 
          [src]="crew.imageLocation || 'assets/default-crew.png'" 
          alt="{{ crew.name }} logo" 
          class="w-16 h-16 object-cover rounded-full border-2 border-purple-400"
          style="min-width: 64px;"
        >
        
        <div class="flex-1">
          <mat-card-title class="text-lg font-semibold text-neon-blue">
            {{ crew.name }}
          </mat-card-title>
          <mat-card-subtitle class="text-gray-300 mb-2">
            Members: {{ crew.users.length }}
          </mat-card-subtitle>
          <mat-card-content class="p-0">
            <p class="text-gray-400">{{ crew.description || 'No description provided.' }}</p>
          </mat-card-content>
        </div>

        <div class="button-container flex-shrink-0">
          <button
            mat-icon-button
            class="text-purple-400 hover:text-purple-600"
            [disabled]="!isMember(crew)"
            [matTooltip]="isMember(crew) ? 'Edit Crew' : 'Only members can edit'"
            (click)="onEditCrew(crew); $event.stopPropagation()"
          >
            <mat-icon>edit</mat-icon>
          </button>
          
          <button
            mat-icon-button
            class="text-red-400 hover:text-red-600"
            [disabled]="!isMember(crew)"
            [matTooltip]="isMember(crew) ? 'Delete Crew' : 'Only members can delete'"
            (click)="onDeleteCrew(crew.id, $event)"
          >
            <mat-icon>delete</mat-icon>
          </button>

          <button
            mat-icon-button
            class="text-blue-400 hover:text-blue-600"
            [matTooltip]="isMember(crew) ? 'View Crew Details' : 'Join Crew (Not yet implemented)'"
            [disabled]="isMember(crew)"
          >
            <mat-icon>visibility</mat-icon>
          </button>
        </div>
      </div>
    </mat-card>
  </div>
</div>